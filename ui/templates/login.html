<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PixTag | Login</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300..700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <link
      href="{{ url_for('static', filename='styles/login.css') }}"
      rel="stylesheet"
    />
    <!-- Font Icon -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
    />
    <!-- Material Design Bootstrap -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css"
      rel="stylesheet"
    />
    <script type="importmap">
      {
        "imports": {
          "@material/web/": "https://esm.run/@material/web/"
        }
      }
    </script>
    <script type="module">
      import "@material/web/all.js";
      import { styles as typescaleStyles } from "@material/web/typography/md-typescale-styles.js";
      document.adoptedStyleSheets.push(typescaleStyles.styleSheet);
    </script>
  </head>
  <body>
    <div class="header">
      <h1>PixTag</h1>
    </div>

    <md-divider></md-divider>

    <div class="container">
      <div class="row justify-content-center">
        <div class="col-md-6">
          <div class="card mt-5">
            <div class="card-body">
              <h3 class="text-center mb-4">Sign In</h3>
              <!-- Material input -->
              <form action="{{ url_for('sign_in') }}" method="post">
                <div class="md-form">
                  <i class="material-icons prefix">person</i>
                  <input
                    type="text"
                    id="username"
                    class="form-control"
                    name="username"
                    ,
                    placeholder="User ID"
                    required
                  />
                </div>
                <br />
                <div class="md-form">
                  <i class="material-icons prefix">lock</i>
                  <input
                    type="password"
                    id="password"
                    class="form-control"
                    name="password"
                    ,
                    placeholder="Password"
                    required
                  />
                </div>
                <br />
                <button
                  type="submit"
                  class="btn btn-primary btn-block mb-4"
                  ,
                  style="width: 100%"
                >
                  Sign in
                </button>
                <div class="text-center">
                  <p>
                    Not a member? <a href="{{ url_for('sign_up') }}">Sign up</a>
                  </p>
                </div>
              </form>
            </div>
            <!-- Modal for displaying messages -->
            <div
              class="modal fade"
              id="messageModal"
              tabindex="-1"
              role="dialog"
              aria-labelledby="messageModalLabel"
              aria-hidden="true"
            >
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="messageModalLabel">
                      Notification
                    </h5>
                    <button
                      type="button"
                      class="btn-close"
                      data-bs-dismiss="modal"
                      aria-label="Close"
                    ></button>
                  </div>
                  <div class="modal-body">
                    {{ message|default('No message') }}
                  </div>
                  <div class="modal-footer">
                    <button
                      type="button"
                      class="btn btn-primary"
                      data-bs-dismiss="modal"
                    >
                      Close
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Bootstrap and MDB scripts -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <!-- Bootstrap 5 JS Bundle (includes Popper) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js"></script>
    <script>
      $(document).ready(function () {
        var show_modal_flag = "{{ show_modal_flag }}";

        console.log(show_modal_flag);
        if (show_modal_flag === "True") {
          $("#messageModal").modal("show");
        }
      });

      if (
        window.performance &&
        window.performance.navigation.type ===
          window.performance.navigation.TYPE_RELOAD
      ) {
        console.log("This page is reloaded");
        window.location.href = "/"; // Redirect to home page
      }
    </script>
  </body>
</html>
